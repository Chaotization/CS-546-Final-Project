{{!-- {{#each events}}
  <h2>{{eventName}}</h2>
  <p>{{description}}</p>
{{/each}} --}}
{{!-- <div class="event-card"> --}}
   
    {{#if isAdmin}}
<div class="container center">
    <h1 id="event-header">Create Events</h1>
   <form method="POST" action="/events" enctype="multipart/form-data">
        <div class="inf">
            <div class="sec-1">
                <label for="eventName">Event Name</label>
                <div class="sec-2">
                    <input id="eventName" type="text" name="eventName">
                </div>
            </div>
        </div>
        <div class="inf">
            <div class="sec-1">
                <label for="description">Description</label>

                <div class="sec-2">
                    <textarea id="description" name="description" rows="6" maxlength="300"></textarea>
                </div>
            </div>
        </div>
        <div class="inf">
            <div class="sec-1">
                <label for="buildingName">Select Building Location:</label>
                <div class="sec-2">
                    <select id="buildingName" name="buildingName">
                        <option value=""></option>
                    </select>

                    <script>
                        const allowedLocation = [
                            "edwin a. stevens hall", "carnegie laboratory", "lieb building", "burchard building",
                            "mclean hall", "babbio center", "morton-pierce-kidde complex", "rocco technology center", "nicholl environmental laboratory",
                            "davidson laboratory", "gatehouse", "griffith building and building technology tower", "walker gymnasium",
                            "schaefer athletic and recreation center", "samuel c. williams library and computer center", "jacobus student center",
                            "alexander house", "colonial house"
                        ];

                        const selectElement = document.getElementById("buildingName");

                        allowedLocation.forEach((location) => {
                            const option = document.createElement("option");
                            option.text = location;
                            option.value = location;
                            selectElement.appendChild(option);
                        });
                    </script>
                </div>
            </div>
        </div>

        <div class="inf">
            <div class="sec-1">
                <label for="organizer">Organizer</label>
                <div class="sec-2">
                    <input id="organizer" type="text" name="organizer">
                </div>
            </div>
        </div>
        <div class="inf">
            <div class="sec-1">
                <label for="seatingCapacity">Seating Capacity</label>
                <div class="sec-2">
                    <input id="seatingCapacity" type="number" name="seatingCapacity">
                </div>
            </div>
        </div>
         <div class="inf">
            <div class="sec-1">
        <label>Upload Image</label>
         <div class="sec-2">
    <input type="file" name="postImage" id="postImage">
    </div>
    </div>
    <button type="submit">Add Post</button>
        <button type="submit" class="registerbtn">Create Event</button>
         {{!-- <button class="delete-btn" onClick="deleteEvent('{{_id}}')" data-event-id="{{_id}}">Delete</button> --}}
    </form>
   
</div>
{{/if}}

<div class="eventPost-container">
    <h2>{{newEvent.eventName}}</h2><br>
    <p>{{newEvent.description}}</p><br>
    <p>{{newEvent.buildingName}}</p><br>
    <p>{{newEvent.seatingCapacity}}</p><br>


    {{#each newEvent}}
    
        <h2>Event Name: {{eventName}}</h2><br>
        <img id="image-preview" src="{{image}}" alt="Event image">
        <p>Description: {{description}}</p><br>
        <p>Building Name: {{buildingName}}</p><br>
        <p>Seating Capacity{{seatingCapacity}}</p><br>
        <form method="POST" action="/events/capacity/{{_id}}" id="allevents-form">
<input type="hidden" id="seatingCapacity" name="seatingCapacity" value="{{seatingCapacity}}">
<input type="hidden" name="formsub" id="formsub_{{_id}}" value="{{attenddone}}">
<button type="submit" id="attbtn_{{_id}}" name="attendance" value="attend">Attend</button>
<button type="submit" id="cancel" name="attendance" value="cancel">Cancel</button>
<button type="submit"  name="reaction" value="like">Like</button>
<button type="submit"  name="reaction" value="dislike">DisLike</button>
</form>

 {{#if ../isAdmin}}

      <button class="delete-btn" onClick="deleteEvent('{{_id}}')" data-event-id="{{_id}}">Delete</button>
   
   {{/if}}
    {{/each}}
    {{!-- <img id="image-preview" src="#" alt="Preview of uploaded image" style="display:none;"> --}}
<p id="error-message">{{Error}}</p>

<script>
    const postImageInput = document.getElementById("postImage");
  const imagePreview = document.getElementById("image-preview");
  postImageInput.addEventListener("change", function () {
    const file = this.files[0];
    const reader = new FileReader();
    reader.addEventListener("load", function () {
      imagePreview.src = reader.result;
      imagePreview.style.display = "block";
    });
    reader.readAsDataURL(file);
  });
  function deleteEvent(id) {
    fetch(`/events/${id}`, {
      method: "delete",
      headers: {
        Accept: 'application/json, text/plain, */*',
        "Content-type": 'application/json'
      },
    })
      .then(response => {
        if (response.ok) {
          alert('event deleted successfully');
          window.location.href = '/events';
        } else {
          throw new Error('Network response was not ok');
        }
      })
      .catch(error => {
        alert(error.message || "Something went wrong.");
      })
      .then(() => {
        console.log('This will run after either success or failure');
      });
  }

</script>

    
</div>

<link rel="stylesheet" href="/public/css/events.css">